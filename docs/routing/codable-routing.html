<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-73924704-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-73924704-2', { 'anonymize_ip': true });
    </script>
    <title>Learn - Getting Started</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="../../css/docs.css">
    <link href=“https://fonts.googleapis.com/css?family=IBM+Plex+Sans” rel=“stylesheet”>
  </head>
  <body>
    <h1>Codable Routing</h1>
    <p>In this guide we will create a simple Kitura server which will have routes defined for the more common HTTP methods.</p>
    <p>We will define these routes using Codable, a Swift protocol.</p>
    <h2>Prerequisites</h2>
    <ul class="plain-list">
      <li><span class="blue-text">Kitura Server:</span> Learn how to create one in our Getting Started guide</li>
    </ul>
    <div class="info">
      <p> We also highly recommend you have logging enabled on your server. You can learn how to add logging in our Logging guide.</p>
    </div>
    <div class="underline"></div>
    <h2><span class="blue-text">Step 1:</span> Create the data model</h2>
    <p>Before we can get started with creating our routes we need to create our data model.</p>
    <p>We will create a Struct called `User` and give it three properties.</p>
    <ol class="plain-list">
      <li>Name of type String</li>
      <li>Age of type Int</li>
      <li>Active of type Bool</li>
    </ol>
    <pre>
    struct User: Codable {
      let name: String
      let age: Int
      let active: Bool
    }</pre>

    <p></p>
    <div class="underline"></div>
    <h2><span class="blue-text">Step 2:</span> Create datastore</h2>
    <p>To begin implementing RestAPI you need a way to store the data.</p>
    <p>A simple way to do this is to create a Dictionary:</p>
    <pre>var userStore: [String: User] = [:]</pre>
    <div class="underline"></div>
    <h2><span class="blue-text">Step 3:</span> Create the Endpoints</h2>
    <h3>POST</h3>
    <p>Register the POST route</p>
    <pre>router.post("/users", handler: postHandler)</pre>
    <p>TODO: Brief explanation of code?</p>
    <p>Define the postHandler function</p>
    <pre>
      func postHandler(user: User, completion: (User?, RequestError?) -> Void) {
        //Add user to the data store
        userStore[user.name] = user
        completion(user, nil)
      }</pre>
    <h3>GET</h3>
    <h4>Get All</h4>
    <p>Register the GET route</p>
    <pre>router.get("/users", handler: getAllHandler)</pre>
    <p>TODO: Brief explanation of code?</p>
    <p>Define the getAllHandler function</p>
    <pre>
      func getAllHandler(completion: ([User]?, RequestError?) -> Void) {
        let users = userStore.map({ $0.value })
        completion(users, nil)
      }</pre>
    <h4>Get Single</h4>
    <p>Register the GET route</p>
    <pre>router.get("/users", handler: getSingleHandler)</pre>
    <p>TODO: Brief explanation of code?</p>
    <p>Define the getSingleHandler function</p>
    <pre>
      func getSingleHandler(id: Int, completion: (User?, RequestError?) -> Void) {
        //Some logic
        completion(user, nil)
      }</pre>
    <h3>DELETE</h3>
    <h4>Delete All</h4>
    <p>Register the delete route</p>
    <pre>router.delete("/users", handler: deleteAllHandler)</pre>
    p>TODO: Brief explanation of code?</p>
    <p>Define the deleteAllHandler function</p>
    <pre>
      func deleteAllHandler(completion: (RequestError?) -> Void) {
        userStore = [:]
        completion(nil)
      }</pre>
    <h4>Delete Single</h4>
    <p>Register the delete route</p>
    <pre>router.delete("/users", handler: deleteSingleHandler)</pre>
    <p>TODO: Brief explanation of code?</p>
    <p>Define the deleteSingleHandler function</p>
    <pre>
      func deleteSingleHandler(id: Int, completion: (RequestError?) -> Void) {
        //Some Logic
        completion(nil)
      }</pre>
    <h3>PUT</h3>
    <p>Register the put route</p>
    <pre>router.put("/users", handler: putHandler)</pre>
    <p>TODO: Brief explanation of code?</p>
    <p>Define the putHandler function</p>
    <pre>
      func putHandler(user: User, completion: (User?, RequestError?) -> Void) {
        //Some Logic
        completion(user, nil)
      }</pre>
    <h3>PATCH</h3>
    <p>Register the PATCH route</p>
    <pre>router.patch("/users", handler: patchHandler)</pre>
    <p>TODO: Brief explanation of code?</p>
    <p>Define the patchHandler function</p>
    <pre>
      func patchHandler(user: User, completion: (User?, RequestError?) -> Void) {
        //Some Logic
        completion(user, nil)
      }</pre>
    <div class="underline"></div>
    <h2><span class="blue-text">Step 4:</span> Test the Endpoints</h2>
    <div class="underline"></div>
    <h2>Next steps</h2>
    <p><span class="blue-text bold">Add logging:</span> Get useful feedback from your server about startup and errors</p>
    <p><span class="blue-text bold">Add routing:</span> Add REST APIs, such as HTTP GET, to your server</p>
  </body>
</html>
